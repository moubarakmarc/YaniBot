<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>YaniBot - ABB IRB6600 Simulator</title>
        <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🤖</text></svg>">
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <!-- Main UI Panel -->
        <div id="ui">
            <div class="ui-header">
                <h1>🤖 YaniBot Control Panel</h1>
            </div>

        <!-- Workspace Information -->
        <div id="workspace-info">
            <h3>📊 Workspace Layout</h3>
            <div class="workspace-legend">
                <div class="workspace-item">
                    <span class="workspace-color red"></span>
                    <span>Safety Boundaries</span>
                </div>
                <div class="workspace-item">
                    <span class="workspace-color yellow"></span>
                    <span>Workspace Boundaries</span>
                </div>
            </div>
        </div>

        <!-- Quick Action Buttons -->
        <div id="quick-actions">
            <h3>Quick Actions</h3>
            <div class="action-buttons">
                <button id="resetScene" class="btn-reset">🔄 Reset Scene</button>
                <button id="emergencyStop" class="btn-emergency">🚨 Emergency Stop</button>
                <button id="resumeEmergency" class="btn-resume" style="display: none;">🔄 Resume Robot</button>
            </div>
        </div>

        <!-- Automation Controls -->
        <div id="automation-controls">
            <h3>🏭 Automation Control</h3>
            
            <!-- Bin Status -->
            <div class="bin-counters">
                <div class="counter-item">
                    <span class="counter-color blue"></span>
                    <span>Left Bin: <span id="left-bin-count">5</span> objects</span>
                </div>
                <div class="counter-item">
                    <span class="counter-color green"></span>
                    <span>Right Bin: <span id="right-bin-count">0</span> objects</span>
                </div>
                <div class="counter-item">
                    <span class="counter-color gray"></span>
                    <span>Cycles: <span id="cycle-count">0</span></span>
                </div>
            </div>
            
            <!-- Main Control Buttons -->
            <div class="automation-buttons">
                <button id="startAutomation" class="btn-start">▶️ Start Automation</button>
                <button id="stopAutomation" class="btn-stop" disabled>⏹️ Stop</button>
                <button id="pauseAutomation" class="btn-pause" disabled>⏸️ Pause</button>
                <button id="resumeAutomation" class="btn-resume" disabled style="display: none;">🔄 Resume</button>
            </div>
            
            <!-- Automation Settings -->
            <div class="automation-settings">
                <div class="setting-group">
                    <label for="automation-strategy">Strategy:</label>
                    <select id="automation-strategy">
                        <option value="left-to-right">Left → Right</option>
                        <option value="right-to-left">Right → Left</option>
                        <option value="bidirectional">Bidirectional</option>
                    </select>
                </div>
            </div>
            
            <!-- Status Display -->
            <div class="status-display">
                <div class="status-row">
                    <span class="status-label">Status:</span>
                    <span id="automation-status" class="status-value">Initial State</span>
                </div>
            </div>
        </div>

        <!-- Manual Override Section -->
        <div id="manual-override">
            <h3>🎮 Manual Joint Control</h3>
            <p class="override-warning">⚠️ Manual Controls can lead to dangers in hands of children</p>

            <!-- Joint Sliders -->
            <div class="joint-controls-grid">
                <div class="joint-control">
                    <div class="joint-label-stack">
                        <label>Base:</label>
                        <span class="joint-limits">-180° to 180°</span>
                    </div>
                    <div class="joint-controls-group">
                        <input type="number" id="a1-input" min="-360" max="360" value="0" step="1" class="joint-input">
                        <span id="a1-value" class="joint-value">0°</span>
                    </div>
                </div>
                <div class="joint-control">
                    <div class="joint-label-stack">
                        <label>Shoulder:</label>
                        <span class="joint-limits">-65° to 80°</span>
                    </div>
                    <div class="joint-controls-group">
                        <input type="number" id="a2-input" min="-360" max="360" value="0" step="1" class="joint-input">
                        <span id="a2-value" class="joint-value">0°</span>
                    </div>
                </div>
                <div class="joint-control">
                    <div class="joint-label-stack">
                        <label>Elbow:</label>
                        <span class="joint-limits">-180° to 60°</span>
                    </div>
                    <div class="joint-controls-group">
                        <input type="number" id="a3-input" min="-360" max="360" value="0" step="1" class="joint-input">
                        <span id="a3-value" class="joint-value">0°</span>
                    </div>
                </div>
                <div class="joint-control">
                    <div class="joint-label-stack">
                        <label>Wrist Roll:</label>
                        <span class="joint-limits">-300° to 300°</span>
                    </div>
                    <div class="joint-controls-group">
                        <input type="number" id="a4-input" min="-360" max="360" value="0" step="1" class="joint-input">
                        <span id="a4-value" class="joint-value">0°</span>
                    </div>
                </div>
                <div class="joint-control">
                    <div class="joint-label-stack">
                        <label>Wrist Pitch:</label>
                        <span class="joint-limits">-120° to 120°</span>
                    </div>
                    <div class="joint-controls-group">
                        <input type="number" id="a5-input" min="-360" max="360" value="0" step="1" class="joint-input">
                        <span id="a5-value" class="joint-value">0°</span>
                    </div>
                </div>
                <div class="joint-control">
                    <div class="joint-label-stack">
                        <label>Flange:</label>
                        <span class="joint-limits">-300° to 300°</span>
                    </div>
                    <div class="joint-controls-group">
                        <input type="number" id="a6-input" min="-360" max="360" value="0" step="1" class="joint-input">
                        <span id="a6-value" class="joint-value">0°</span>
                    </div>
                </div>
            </div>
            <!-- Send Manual Control Values -->
            <div class="manual-buttons">
                <button id="setJoints" class="btn-set-joints">🔧 Set Joint Angles</button> 
            </div>
            
            <!-- Manual Control Buttons -->
            <div class="manual-buttons">
                <button id="resetJoints" class="btn-reset">🏠 Reset to Home</button> 
            </div>
        </div>
        
        <!-- Log Controls Dropdown -->
        <div id="log-controls" class="dropdown-section">
            <button id="logDropdownBtn" class="dropdown-btn">Log Options ▼</button>
            <div id="logDropdown" class="dropdown-content">
                <label><input type="checkbox" id="logState" checked> State</label><br>
                <label><input type="checkbox" id="logReset" checked> Reset</label><br>
                <label><input type="checkbox" id="logInterpolatedPath" checked> Interpolated Path</label><br>
                <label><input type="checkbox" id="logJointLimits" checked> Joint Limits</label><br>
                <label><input type="checkbox" id="logMovingState" checked> Moving State</label><br>
                <label><input type="checkbox" id="logCurrentAngles" checked> Current Angles</label><br>
                <label><input type="checkbox" id="logStopState" checked> Stop State</label><br>
                <label><input type="checkbox" id="logPauseState" checked> Pause State</label><br>
                <label><input type="checkbox" id="logEmergencyState" checked> Emergency State</label><br>
                <label><input type="checkbox" id="logSafetyMode" checked> Safety Mode</label>
            </div>
        </div>

        <div class="stat-item">
                <span class="stat-label">Robot Model:</span>
                <span class="stat-value">ABB IRB6600</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">DOF:</span>
                <span class="stat-value">6-Axis</span>
        </div>
    </div>
    
    <!-- 3D Scene Container -->
    <div id="canvas-container"></div>

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>🤖 YaniBot Loading...</h2>
            <p id="loading-status">Initializing components...</p>
        </div>
    </div>

    <!-- Scripts - Load in correct order -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Load env.js FIRST before other modules -->
    <script src="js/env.js"></script>    

    <!-- Load modular components -->
    <script src="js/scene.js"></script>
    <script src="js/build_robot.js"></script>
    <script src="js/robot.js"></script>
    <script src="js/automation.js"></script>
    <script src="js/emergency.js"></script>
    <script src="js/bin.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/main.js"></script>

</body>
</html>